// タスクの準備
CREATE OR REPLACE TRANSIENT DATABASE TASK_DB;

CREATE OR REPLACE TABLE CUSTOMERS (
  CUSTOMER_ID INT AUTOINCREMENT STRAT = 1 INCREMENT =1,
  FIRST_NAME VARCHAR(40) DEFAULT 'JENNIFER',
  CREATE_DATE DATE
);


--実際にタスクを作成
CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '1 MINUTE' #1分ごとにデータが挿入される
    AS
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP);

SHOW TASKS;

-- タスクの再開と停止
ALTER TASK CUSTOMER_INSERT RESUME;
ALTER TASK CUSTOMER_INSERT SUSPEND;

SELECT * FROM CUSTOMERS;


-- クーロンによるタスクの設定
CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = 'USING CRON 0 16,19 * * 5L Asia/Tokyo' #「その月の最後の金曜日」の日本時刻に16時と19時実行される
    AS
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP);

/*
minute(0-59)
hour(0-23)
day of month (1-31, or L)
month (1-12, JAN-DEC)
day of week (0-6, SUN-SAT, or L)
***** :毎日
*/

/*(補足)
日本時刻はUTC+9時間後
*/
