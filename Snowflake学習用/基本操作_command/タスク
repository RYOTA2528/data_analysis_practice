// タスクの準備
CREATE OR REPLACE TRANSIENT DATABASE TASK_DB;

CREATE OR REPLACE TABLE CUSTOMERS (
  CUSTOMER_ID INT AUTOINCREMENT STRAT = 1 INCREMENT =1,
  FIRST_NAME VARCHAR(40) DEFAULT 'JENNIFER',
  CREATE_DATE DATE
);


--実際にタスクを作成
CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '1 MINUTE' #1分ごとにデータが挿入される
    AS
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP);

SHOW TASKS;

-- タスクの再開と停止
ALTER TASK CUSTOMER_INSERT RESUME;
ALTER TASK CUSTOMER_INSERT SUSPEND;

SELECT * FROM CUSTOMERS;

