-- ストレージ統合
CREATE OR REPLACE STORAGE INTEGRATION s3_int
  TYPE = EXTERNAL_STAGE
  STORAGE_PROVIDER = S3
  ENABLED = TRUE
  STORAGE_AWS_ROLE_AREN = '<Snowflake用のロールのARN>'
  STORAGE_ALLOWD_LOCATIONS = ('s3://<your-bucket-name>/<your-path>/', 's3://<your-bucket-name>/<your-path>/')
    COMENT = 'aaaa'

-- 確認
DESC INTEGRATION s3_int;

-- FileFormatの作成
CREATE OR REPLACE file format MANAGE_DB.file_formats.csv_fileformat
  type = csv
  field_delimiter = ','
  skip_header = 1
  null_if = ('NULL', 'null') #ファイル内で 'NULL' または 'null' という文字列があった場合、それをNULL値として扱う。
  empty_field_as_null = TRUE;　#フィールドが空の時はNULLとして扱う

-- ステージの作成
CREATE OR REPLACE stage MANAGE_DB.external_stages.csv_folder
  URL = 's3://<your-bucket-name>/<your-path>/'
　STORAGE_INTEGRATION = s3_int
  FILE_FORMAT = MANAGE_DB.file_formats.csv_fileformat
