/*【Chapter1:S3アクセスログの取り込み方を学ぶ】*/

/*
S3 アクセスログを Snowflake に取り込みにあたり、自動取り込み・処理パイプラインの設定方法の詳細な手順に加え、データ損失防止とインシデント対応のためのサンプルクエリも実行
*/

/*
前提条件：
・IAM ポリシーとロールを作成および管理する権限を持つ AWS ユーザー
・テーブル、ステージ、タスク、ストリーム、ストレージ統合を作成し、snowpipe をセットアップする権限を持つ Snowflake ユーザー。
・S3 ログ バケット (Snowflake ターゲット アカウントと同じリージョンにあることが推奨)
*/


/*
【設計UI図(イメージ)】
(AWSCloud側)
S3 Source Bucket
↓ ログを送信
S3 External Stage
↓ イベント通知
SQSキューへの送信
（Snowflake上）
↓ 検知
Snowwpipe
↓ コピー
Stage
↓Streamによる自動送信
関数の実行
↓
ターゲットテーブル上でのアクセスログの格納
*/